WARNING: Logging before flag parsing goes to stderr.
W0929 11:38:11.443646 140163263338304 deprecation_wrapper.py:119] From /net/bigdata/home/bigdata/thomas/tam/misgan/model_gain.py:53: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0929 11:38:11.516240 140163263338304 deprecation_wrapper.py:119] From /net/bigdata/home/bigdata/thomas/tam/misgan/model_gain.py:9: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

W0929 11:38:11.659374 140163263338304 deprecation_wrapper.py:119] From /net/bigdata/home/bigdata/thomas/tam/misgan/model_gain.py:93: The name tf.log is deprecated. Please use tf.math.log instead.

W0929 11:38:11.700814 140163263338304 deprecation_wrapper.py:119] From /net/bigdata/home/bigdata/thomas/tam/misgan/model_gain.py:103: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

W0929 11:38:11.866062 140163263338304 deprecation.py:323] From /home/bigdata/thomas/vinh/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1205: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0929 11:38:12.033567 140163263338304 deprecation_wrapper.py:119] From gain_uce2.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-09-29 11:38:12.034773: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2019-09-29 11:38:12.043190: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.044076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.683
pciBusID: 0000:41:00.0
2019-09-29 11:38:12.044300: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2019-09-29 11:38:12.045458: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
2019-09-29 11:38:12.046683: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0
2019-09-29 11:38:12.046905: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0
2019-09-29 11:38:12.048271: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0
2019-09-29 11:38:12.049359: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0
2019-09-29 11:38:12.052616: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2019-09-29 11:38:12.052774: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.053745: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.054664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2019-09-29 11:38:12.055020: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-09-29 11:38:12.061722: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3792520000 Hz
2019-09-29 11:38:12.062759: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55af1d548390 executing computations on platform Host. Devices:
2019-09-29 11:38:12.062786: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2019-09-29 11:38:12.063055: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.064013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.683
pciBusID: 0000:41:00.0
2019-09-29 11:38:12.064063: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2019-09-29 11:38:12.064076: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
2019-09-29 11:38:12.064088: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0
2019-09-29 11:38:12.064098: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0
2019-09-29 11:38:12.064109: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0
2019-09-29 11:38:12.064119: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0
2019-09-29 11:38:12.064129: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2019-09-29 11:38:12.064171: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.065052: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.065900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2019-09-29 11:38:12.065925: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2019-09-29 11:38:12.230085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-09-29 11:38:12.230131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2019-09-29 11:38:12.230141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2019-09-29 11:38:12.230383: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.231310: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.232193: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-09-29 11:38:12.233064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8356 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:41:00.0, compute capability: 6.1)
2019-09-29 11:38:12.239991: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55af1dcc7700 executing computations on platform CUDA. Devices:
2019-09-29 11:38:12.240007: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
W0929 11:38:12.242992 140163263338304 deprecation_wrapper.py:119] From gain_uce2.py:28: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-09-29 11:38:13.314492: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
W0929 11:42:59.502556 140163263338304 deprecation_wrapper.py:119] From gain_uce2.py:56: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

Iter: 0
Train_loss: 0.366
Test_loss: 0.3583

Iter: 10000
Train_loss: 0.03256
Test_loss: 0.07972

Iter: 20000
Train_loss: 0.02882
Test_loss: 0.08186

Iter: 30000
Train_loss: 0.0251
Test_loss: 0.1047

Iter: 40000
Train_loss: 0.02888
Test_loss: 0.0966

